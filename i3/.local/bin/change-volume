#!/bin/sh
# change-volume
# adapted from https://github.com/mohabaks

# return mute as boolean
function muted() {
	percentage=$(pactl get-sink-mute @DEFAULT_SINK@ | awk '/Mute/ {print $2; exit}')
	case $percentage in
	no)
		echo 0
		;;
	yes)
		echo 1
		;;
	esac
}

# return volume as number (no percent sign)
function volume() {
	percentage=$(pactl get-sink-volume @DEFAULT_SINK@ | awk '/Volume/ {print $5; exit}')
	echo ${percentage%\%}
}

function send_notification {
	verb=$1
    if [ $verb = "muted" ]; then
        volume=0
    else
	    volume=$(volume)
    fi
	notify-send \
		-u low \
		-t 1500 \
		-h string:x-canonical-private-synchronous:change-volume \
		-h int:value:"$volume" \
		-h string:hlcolor:#50fa7b \
        "Volume $verb. ($volume)"
}

case $1 in
up)
	pactl set-sink-volume @DEFAULT_SINK@ +5%
	send_notification increased
	;;
down)
	pactl set-sink-volume @DEFAULT_SINK@ -5%
	send_notification decreased
	;;
mute)
	pactl set-sink-mute @DEFAULT_SINK@ toggle
	if [ $(muted) -eq 0 ]; then
		send_notification unmuted
	elif [ $(muted) -eq 1 ]; then
		send_notification muted
	fi
	;;
esac
